# BRIA 背景移除

一个强大的 OOMOL 包,使用 BRIA AI 背景移除 API 来移除图像背景。该包提供基于 URL 和基于文件的工作流,可以无缝集成背景移除功能到您的图像处理流程中。

## 功能特性

- 通过 URL 移除图像背景
- 从本地图像文件移除背景
- 自动云端上传和下载
- 可配置的轮询等待任务完成
- 易于使用的子流程块

## 子流程

该包包含两个主要子流程,适用于不同的使用场景:

### 1. URL 图像背景移除

从图像 URL 移除背景并返回处理后的图像 URL。

**输入:**
- `imageURL` (字符串,必需): 要移除背景的图像 URL
- `max_retries` (数字,可选): 最大轮询尝试次数(默认: 30)
- `retry_interval` (数字,可选): 轮询尝试之间的间隔秒数(默认: 2)

**输出:**
- `result_url` (字符串): 移除背景后的处理图像 URL

**使用场景:** 适合处理网络托管的图像或希望将图像保留在云端的情况。

### 2. 文件图像背景移除

从本地图像文件移除背景并保存处理结果。

**输入:**
- `image_file` (文件,必需): 要处理的本地图像文件
- `saved_path` (字符串,可选): 保存处理后图像的路径
- `max_retries` (数字,可选): 最大轮询尝试次数(默认: 30)
- `retry_interval` (数字,可选): 轮询尝试之间的间隔秒数(默认: 2)

**输出:**
- `saved_path` (字符串): 成功下载的处理图像的路径

**使用场景:** 适合批量处理本地图像或将背景移除集成到基于文件的工作流中。

## 基本用法

### 使用 URL 图像背景移除

1. 将 `url-image-background-removal` 子流程添加到您的工作流
2. 将图像 URL 连接到 `imageURL` 输入
3. 处理后的图像 URL 将在 `result_url` 输出中可用

### 使用文件图像背景移除

1. 将 `file-image-background-removal` 子流程添加到您的工作流
2. 使用 `image_file` 输入选择本地图像文件
3. 可选择在 `saved_path` 中指定结果保存位置
4. 处理后的图像将被保存,其路径在输出中返回

## 任务块

该包包含两个核心任务块(标记为私有,供内部使用):

### 提交背景移除

将图像提交到背景移除 API 并返回用于跟踪任务状态的请求 ID。

### 获取背景移除结果

轮询背景移除 API 以在任务完成后检索处理后的图像 URL。

## 依赖项

该包需要以下 OOMOL 包:
- `upload-to-cloud` (v0.0.5): 用于将本地文件上传到云存储
- `downloader` (v0.1.1): 用于下载处理后的图像

## 安装

可以通过 OOMOL 包管理器安装该包:

```bash
# 安装包
oomol install bria-removebg

# 添加到工作空间依赖项
oomol use bria-removebg
```

## 配置

背景移除服务使用 OOMOL Fusion API。无需额外的 API 密钥配置 - 该包会自动使用您的 OOMOL 令牌进行身份验证。

## 技术细节

### 工作流架构

两个子流程都遵循类似的模式:

1. **提交阶段**: 将图像(URL 或上传的文件)提交到 BRIA API
2. **轮询阶段**: 持续检查任务状态直到完成
3. **检索阶段**: 返回或下载处理后的图像

### 轮询机制

轮询系统包括:
- 可配置的重试次数以处理长时间的处理过程
- 可调整的重试间隔以平衡响应性和 API 负载
- 自动错误处理和状态报告

### API 集成

该包通过 OOMOL 的 Fusion API 端点与 BRIA AI 背景移除 API 集成:
- 基础 URL: `https://fusion-api.oomol.com/v1`
- 身份验证: 通过 OOMOL 令牌自动进行
- 端点: `/image/background-removal` 用于提交和结果检索

## 错误处理

该包包含强大的错误处理:
- 连接失败会报告清晰的错误消息
- 超时场景得到优雅处理
- 在整个过程中跟踪和报告任务状态

## 版本

当前版本: 0.0.1

## 许可证

该包作为 OOMOL 生态系统的一部分提供。
